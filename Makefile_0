ifndef submission
$(error submission is undefined)
endif

build:
	rm -Rf /home/woody/iwb3/iwb3021h/THESIS_RESULTS/package0
	mkdir /home/woody/iwb3/iwb3021h/THESIS_RESULTS/package0
	mkdir /home/woody/iwb3/iwb3021h/THESIS_RESULTS/package0/predictions
	mkdir /home/woody/iwb3/iwb3021h/THESIS_RESULTS/package0/datasets
	rsync -ar --exclude='**/test_y.npy' datasets/* /home/woody/iwb3/iwb3021h/THESIS_RESULTS/package0/datasets/
	cp -R evaluation/main.py /home/woody/iwb3/iwb3021h/THESIS_RESULTS/package0/main.py
	cp -R $(submission)/* /home/woody/iwb3/iwb3021h/THESIS_RESULTS/package0

run:
	cd /home/woody/iwb3/iwb3021h/THESIS_RESULTS/package0; python3 main.py --mode T0 --select_augment Resnet

score:
	rm -Rf /home/woody/iwb3/iwb3021h/THESIS_RESULTS/scoring0
	mkdir /home/woody/iwb3/iwb3021h/THESIS_RESULTS/scoring0
	mkdir /home/woody/iwb3/iwb3021h/THESIS_RESULTS/scoring0/labels
	mkdir /home/woody/iwb3/iwb3021h/THESIS_RESULTS/scoring0/predictions
	rsync -avr --exclude='**/*x.npy' --exclude='**/train*.npy' --exclude='**/valid*.npy'   --include='**/test_y.npy' datasets/* /home/woody/iwb3/iwb3021h/THESIS_RESULTS/scoring0/labels/
	cp -R /home/woody/iwb3/iwb3021h/THESIS_RESULTS/package0/predictions /home/woody/iwb3/iwb3021h/THESIS_RESULTS/scoring0
	cp evaluation/score.py /home/woody/iwb3/iwb3021h/THESIS_RESULTS/scoring0/score.py
	cd /home/woody/iwb3/iwb3021h/THESIS_RESULTS/scoring0; python3 score.py

clean:
	rm -Rf /home/woody/iwb3/iwb3021h/THESIS_RESULTS/scoring0
	rm -Rf /home/woody/iwb3/iwb3021h/THESIS_RESULTS/package0

zip:
	cd $(submission);  zip -r ../submission.zip *

all: clean build run score